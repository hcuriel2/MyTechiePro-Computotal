{"ast":null,"code":"import { first } from \"rxjs/operators\";\nimport { MatSnackBarConfig } from \"@angular/material/snack-bar\";\nimport { Constants } from \"src/app/shared/constants/constants\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/project.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@ngx-translate/core\";\nimport * as i5 from \"src/app/shared/services/user.service\";\nimport * as i6 from \"src/app/shared/services/auth.service\";\nimport * as i7 from \"src/app/shared/services/category.service\";\nimport * as i8 from \"@angular/common/http\";\nfunction ProDetailsComponent_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.alias + \" (\" + ctx_r0.rating + \" stars)\");\n  }\n}\nfunction ProDetailsComponent_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.name + \" (\" + ctx_r2.rating + \" stars)\");\n  }\n}\nexport let ProDetailsComponent = /*#__PURE__*/(() => {\n  class ProDetailsComponent {\n    constructor(projectService, route, router, snackBar, translateService, userService, authService, categoryService, changeDetectorRef, http) {\n      this.projectService = projectService;\n      this.route = route;\n      this.router = router;\n      this.snackBar = snackBar;\n      this.translateService = translateService;\n      this.userService = userService;\n      this.authService = authService;\n      this.categoryService = categoryService;\n      this.changeDetectorRef = changeDetectorRef;\n      this.http = http;\n      this.displayedColumnsAccount = [\"key\", \"value\"];\n      this.dataSource = [];\n      this.dataSourceBad = [];\n      this.range = 10;\n      this.selectedOption = \"10\";\n      this.isFeedbackVisible = false;\n      this.isShowMoreBtnVisible = false;\n      this.isCardListVisible = false;\n      // geolocation variables\n      this.latitude = 0;\n      this.longitude = 0;\n      // public canadaPostalCodeRegex: RegExp = new RegExp(\n      //   \"^[ABCEGHJ-NPRSTVXY][0-9][ABCEGHJ-NPRSTV-Z][ -]?[0-9]??[ABCEGHJ-NPRSTV-Z]??[0-9]??$\",\n      //   \"im\"\n      // );\n      // public usZipCodeRegex: RegExp = new RegExp(\n      //   \"^[0-9]{5}(?:[ -][0-9]{4})?$\",\n      //   \"im\"\n      // );\n      this.googleMapApiUrl = \"https://maps.googleapis.com/maps/api/geocode/json\";\n      this.googleMapApiKey = \"AIzaSyDS_bEoW2tmdRW-WyWaZIS_gnsbWQ1stUU\";\n      //Options for selecting range for techie location.\n      this.options = [{\n        name: \"10\",\n        value: 10\n      }, {\n        name: \"20\",\n        value: 20\n      }, {\n        name: \"50\",\n        value: 50\n      }, {\n        name: \"100\",\n        value: 100\n      }, {\n        name: \"All\",\n        value: 9999999\n      }];\n      this.displayedColumnsProjects = [\"serviceName\", \"state\", \"feedback\", \"ratings\", \"createdAt\"];\n      this.dataSourceProjects = [];\n      this.displayedColumnsRatings = [\"clientName\", \"service\", \"feedback\", \"ratings\"];\n      this.dataSourceRatings = [];\n      this.route.queryParams.subscribe(params => {\n        this.categorySelection = params.category;\n        this.serviceSelection = params.service;\n      });\n    }\n    ngOnInit() {\n      this.view_account_info();\n      // this.view_projects();\n    }\n    view_account_info() {\n      console.log(\"history.state\", history.state);\n      this.id = history.state.pro._id;\n      this.alias = history.state.pro.alias;\n      this.name = history.state.pro.firstName + \" \" + history.state.pro.lastName;\n      this.companyName = history.state.pro.company;\n      this.email = history.state.email;\n      this.phoneNumber = history.state.pro.phoneNumber;\n      this.address = history.state.pro.address.street + \"\\n\" + history.state.pro.address.city + \" \" + history.state.pro.address.postalCode + \" \" + history.state.pro.address.country;\n      this.skills = history.state.pro.skills;\n      this.unitPrice = \"$\" + history.state.pro.unitPrice + \"/\" + history.state.pro.unitType;\n      this.bio = history.state.pro.bio;\n      this.status = history.state.pro.proStatus;\n      this.rating = history.state.pro.ratingSum / history.state.pro.ratingCount;\n      this.website = history.state.pro.website;\n      this.categorySelection = history.state.categoryId;\n      this.dataSource = [{\n        key: \"Name\",\n        value: this.name\n      }, {\n        key: \"Phone Number\",\n        value: this.phoneNumber\n      }, {\n        key: \"Email\",\n        value: this.email\n      }, {\n        key: \"Address\",\n        value: this.address\n      }, {\n        key: \"Unit Price\",\n        value: this.unitPrice\n      }, {\n        key: \"Status\",\n        value: this.status\n      }, {\n        key: \"Bio\",\n        value: this.bio\n      }, {\n        key: \"Skills\",\n        value: this.skills\n      }, {\n        key: \"Rating\",\n        value: this.rating\n      }, {\n        key: \"Website\",\n        value: this.website\n      }];\n    }\n    techSelect(id) {\n      this.selectedTechID = id;\n      this.createProject();\n      // const serviceName = history.state.serviceName;\n      //  console.log(serviceName + \" \" + this.categorySelection + \" \" + history.state.serviceId);\n    }\n    // Create a project listing with selected techie and redirect user to project page.\n    createProject() {\n      this.authService.getUserInfo().subscribe({\n        next: user => {\n          const clientId = user === null || user === void 0 ? void 0 : user._id;\n          const professionalId = this.selectedTechID;\n          const serviceName = history.state.serviceName;\n          const categoryId = this.categorySelection;\n          const serviceId = history.state.serviceId;\n          if (!clientId) {\n            console.warn(\"You're not logged in, please log in and try it again\");\n            this.translateService.get('Message.SignInFirst').pipe(first()).subscribe(translation => {\n              const config = new MatSnackBarConfig();\n              config.duration = Constants.ShortDuration;\n              this.snackBar.open(translation, 'OK', config);\n            });\n          } else if (clientId && professionalId && serviceName && categoryId && serviceId) {\n            this.projectService.create(categoryId, serviceId, serviceName, professionalId, clientId).subscribe(project => {\n              this.router.navigateByUrl(`/project/${project._id}`);\n            });\n          } else {\n            console.warn('ServiceTechnicianSelectComponent: createProject: some data is missing');\n          }\n        },\n        error: err => {\n          console.error('Error fetching user info:', err);\n          // Handle the error appropriately\n        }\n      });\n    }\n    view_projects() {\n      this.projectService.getProjectsByProId(history.state._id).pipe(first()).subscribe(projects => {\n        // console.log(projects);\n        this.dataSourceProjects = projects;\n        // this.dataSource = new MatTableDataSource(this.dataSourceProjects);\n        // this.dataSource.sort = this.sort;\n        console.log(\"proj\", this.dataSourceProjects);\n      });\n    }\n  }\n  ProDetailsComponent.ɵfac = function ProDetailsComponent_Factory(t) {\n    return new (t || ProDetailsComponent)(i0.ɵɵdirectiveInject(i1.ProjectService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.TranslateService), i0.ɵɵdirectiveInject(i5.UserService), i0.ɵɵdirectiveInject(i6.AuthService), i0.ɵɵdirectiveInject(i7.CategoryService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i8.HttpClient));\n  };\n  ProDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProDetailsComponent,\n    selectors: [[\"app-pro-details\"]],\n    decls: 45,\n    vars: 10,\n    consts: [[1, \"container\", \"m-4\"], [1, \"row\"], [1, \"pl-2\"], [\"onclick\", \"location.href='/service-tech-select'\", 1, \"backBtn\", \"btn\", \"btn-primary\", \"mb-3\"], [1, \"row\", \"mt-3\"], [1, \"col-md-12\", \"pl-2\"], [3, \"ngIf\", \"ngIfElse\"], [\"none\", \"\"], [1, \"tabopen\", \"btn\", \"btn-primary\", \"mt-3\", 3, \"click\"], [1, \"textStyle\"]],\n    template: function ProDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"button\", 3)(4, \"p\");\n        i0.ɵɵtext(5, \"Back\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5);\n        i0.ɵɵtemplate(8, ProDetailsComponent_ng_template_8_Template, 2, 1, \"ng-template\", 6);\n        i0.ɵɵtemplate(9, ProDetailsComponent_ng_template_9_Template, 2, 1, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementStart(11, \"p\")(12, \"strong\");\n        i0.ɵɵtext(13, \"Company Name:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"p\")(16, \"strong\");\n        i0.ɵɵtext(17, \"Name:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"p\")(20, \"strong\");\n        i0.ɵɵtext(21, \"Email:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"p\")(24, \"strong\");\n        i0.ɵɵtext(25, \"Phone Number:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"p\")(28, \"strong\");\n        i0.ɵɵtext(29, \"Address:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"p\")(32, \"strong\");\n        i0.ɵɵtext(33, \"Skills:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(34);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"p\")(36, \"strong\");\n        i0.ɵɵtext(37, \"Unit Price:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(38);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"p\")(40, \"strong\");\n        i0.ɵɵtext(41, \"Pro ID:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(42);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function ProDetailsComponent_Template_button_click_43_listener() {\n          return ctx.techSelect(ctx.id);\n        });\n        i0.ɵɵtext(44, \" Create a Project \");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(10);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngIf\", ctx.avgRating >= 0)(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\" \", ctx.companyName, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.name, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.email, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.phoneNumber, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.address, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.skills, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.unitPrice, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.id, \"\");\n      }\n    },\n    styles: [\".mat-tab-group[_ngcontent-%COMP%]{margin-top:30px;width:1200px}table[_ngcontent-%COMP%]{width:100%}.example-viewport[_ngcontent-%COMP%]{width:100%;height:350px}.example-item[_ngcontent-%COMP%]{height:50px}.boldText[_ngcontent-%COMP%]{font-weight:700}.tableStyle[_ngcontent-%COMP%]{margin-top:0}.textStyle[_ngcontent-%COMP%]{padding-top:25px;font-size:x-large;font-weight:700;color:#002b5c}.backBtn[_ngcontent-%COMP%]{color:#002b5c;float:right}.backBtn[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#fff}.mat-column-feedback[_ngcontent-%COMP%]{padding:2px;word-wrap:break-word!important;white-space:unset!important;flex:0 0 28%!important;width:28%!important;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}\"],\n    changeDetection: 0\n  });\n  return ProDetailsComponent;\n})();\nconst PROJECTS_DATA = [{\n  projectId: 1,\n  customerUser: \"user1\",\n  customerId: 5,\n  serviceType: \"Network Installation\"\n}, {\n  projectId: 2,\n  customerUser: \"user2\",\n  customerId: 5,\n  serviceType: \"Windows Installation\"\n}];","map":null,"metadata":{},"sourceType":"module"}